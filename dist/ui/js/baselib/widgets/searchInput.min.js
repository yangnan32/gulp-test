zWidgets.searchInput=function(data){var searchInputObj={id:data.id,changeUrl:data.url,key:data.key,dataName:data.dataName,dataRoot:data.dataRoot,selectData:"",showY:0};searchInputObj.renderSelectDiv=function(){var t=parseInt($("#"+searchInputObj.id).next("input").width()+20),e=$('<div id="'+searchInputObj.id+'Div" class="widgets-searchInput-div" style="width:'+t+'px"><ul></ul></div>');$("#"+searchInputObj.id).parents("div.widget-searchInput").append(e)},searchInputObj.renderSelectDiv(),searchInputObj.initEmptyText=function(){var t=$("#"+searchInputObj.id).next("input");""==$("#"+searchInputObj.id).val()&&t.attr("emptyText")&&""!=t.attr("emptyText")?t.val(t.attr("emptyText")).addClass("uiframe-emptyTextColor"):t.removeClass("uiframe-emptyTextColor")},searchInputObj.load=function(url,val){var _url="";_url=-1!=url.indexOf("?")?url+"&":url+"?",_url+=searchInputObj.dataName+"="+val,$.ajax({type:"GET",url:_url,dataType:"json",data:"",success:function(data_name){if(data_name){var datas;if(void 0==(datas=searchInputObj.dataRoot&&""!=searchInputObj.dataRoot?eval("data_name."+searchInputObj.dataRoot)||[]:eval("data_name")||[]))return;searchInputObj.totalCount=datas.recordtotal||0,searchInputObj.selectData=datas.resultSet||[]}var $showDiv=$("#"+searchInputObj.id+"Div"),$ul=$showDiv.find("ul");$ul.empty();for(var i=0;i<searchInputObj.selectData.length;i++){var record=searchInputObj.selectData[i];if(record){var note=1==record.checked?"已添加":"",cls=1==record.checked?"":"widgetsSearchInputLi",columnKey=record[searchInputObj.key],$li=$('<li class="'+cls+'" val="'+columnKey+'"><img src="'+record.headImg+'"><div class="showName textOver" style="width:'+($showDiv.width()-100)+'px">'+record.name+"</div><span>"+note+"</span></li>");$ul.append($li)}}if($showDiv.show(),""==searchInputObj.showY||"0"==searchInputObj.showY)return!1;var $showDiv=$("#"+searchInputObj.selectDivId),showH=$showDiv.height(),bodyH=$(window).height();searchInputObj.showY+showH+30>bodyH&&searchInputObj.showY>showH+1?$showDiv.css("margin-top",-(showH+1)):$showDiv.css("margin-top",$("#"+searchInputObj.id).next("input").height()+1)},error:function(t,e,a){}})},$(document).on("focus","#"+searchInputObj.id+"Input",function(){$(this).hasClass("uiframe-emptyTextColor")&&$(this).val("").removeClass("uiframe-emptyTextColor"),$(this).parents("div.widget-searchInput").find(".widgetsSearchInputDelete").show()}).on("keyup","#"+searchInputObj.id+"Input",function(t){if(searchInputObj.showY=$(t.target).offset().top,t.ctrlKey||t.shiftKey||16==t.keyCode||17==t.keyCode)return!1;40!==t.keyCode&&39!==t.keyCode&&38!==t.keyCode&&37!==t.keyCode&&27!==t.keyCode&&searchInputObj.load(searchInputObj.changeUrl,$(this).val())}),$("#"+searchInputObj.id).on("initEmptyText",function(){searchInputObj.initEmptyText()}),searchInputObj.initEmptyText(),$("#"+searchInputObj.id).parents("div.widget-searchInput").attr("data-parserFlag",!0)},$(function(){zWidgets._document.on("click",".widgetsSearchInputLi",function(){var t=$(this),e=t.parents("div.widget-searchInput"),a=$("#"+e.data("id")),r=e.find(".widgets-searchInput-div");return e.find(".widgetsSearchInputDelete").hide(),a.val(t.attr("val")),a.next("input").val(t.find("p").text()),r.hide(),a.trigger("initEmptyText"),a.trigger("change",[t.attr("val"),t.find("p").text()]),!1}).on("click",".widgetsSearchInputDelete",function(){var t=$(this).parents("div.widget-searchInput"),e=$("#"+t.data("id")),a=t.find(".widgets-searchInput-div");return $(this).hide(),e.val(""),e.next("input").val(""),a.hide(),e.trigger("initEmptyText"),e.trigger("change",["",""]),!1})});